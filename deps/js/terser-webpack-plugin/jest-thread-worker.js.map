{"version":3,"file":"js/terser-webpack-plugin/jest-thread-worker.js","mappings":"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","sources":["webpack://@ease-js/packer/../node_modules/.pnpm/jest-worker@29.3.1/node_modules/jest-worker/build/types.js","webpack://@ease-js/packer/webpack/bootstrap","webpack://@ease-js/packer/webpack/runtime/define property getters","webpack://@ease-js/packer/webpack/runtime/hasOwnProperty shorthand","webpack://@ease-js/packer/external module \"node:worker_threads\"","webpack://@ease-js/packer/external module \"node:module\"","webpack://@ease-js/packer/../deps/entry/terser-webpack-plugin/jest-thread-worker.ts"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.WorkerStates =\n  exports.WorkerEvents =\n  exports.PARENT_MESSAGE_SETUP_ERROR =\n  exports.PARENT_MESSAGE_OK =\n  exports.PARENT_MESSAGE_MEM_USAGE =\n  exports.PARENT_MESSAGE_CUSTOM =\n  exports.PARENT_MESSAGE_CLIENT_ERROR =\n  exports.CHILD_MESSAGE_MEM_USAGE =\n  exports.CHILD_MESSAGE_INITIALIZE =\n  exports.CHILD_MESSAGE_END =\n  exports.CHILD_MESSAGE_CALL =\n    void 0;\n/**\n * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// Because of the dynamic nature of a worker communication process, all messages\n// coming from any of the other processes cannot be typed. Thus, many types\n// include \"unknown\" as a TS type, which is (unfortunately) correct here.\n\nconst CHILD_MESSAGE_INITIALIZE = 0;\nexports.CHILD_MESSAGE_INITIALIZE = CHILD_MESSAGE_INITIALIZE;\nconst CHILD_MESSAGE_CALL = 1;\nexports.CHILD_MESSAGE_CALL = CHILD_MESSAGE_CALL;\nconst CHILD_MESSAGE_END = 2;\nexports.CHILD_MESSAGE_END = CHILD_MESSAGE_END;\nconst CHILD_MESSAGE_MEM_USAGE = 3;\nexports.CHILD_MESSAGE_MEM_USAGE = CHILD_MESSAGE_MEM_USAGE;\nconst PARENT_MESSAGE_OK = 0;\nexports.PARENT_MESSAGE_OK = PARENT_MESSAGE_OK;\nconst PARENT_MESSAGE_CLIENT_ERROR = 1;\nexports.PARENT_MESSAGE_CLIENT_ERROR = PARENT_MESSAGE_CLIENT_ERROR;\nconst PARENT_MESSAGE_SETUP_ERROR = 2;\nexports.PARENT_MESSAGE_SETUP_ERROR = PARENT_MESSAGE_SETUP_ERROR;\nconst PARENT_MESSAGE_CUSTOM = 3;\nexports.PARENT_MESSAGE_CUSTOM = PARENT_MESSAGE_CUSTOM;\nconst PARENT_MESSAGE_MEM_USAGE = 4;\nexports.PARENT_MESSAGE_MEM_USAGE = PARENT_MESSAGE_MEM_USAGE;\nlet WorkerStates;\nexports.WorkerStates = WorkerStates;\n(function (WorkerStates) {\n  WorkerStates['STARTING'] = 'starting';\n  WorkerStates['OK'] = 'ok';\n  WorkerStates['OUT_OF_MEMORY'] = 'oom';\n  WorkerStates['RESTARTING'] = 'restarting';\n  WorkerStates['SHUTTING_DOWN'] = 'shutting-down';\n  WorkerStates['SHUT_DOWN'] = 'shut-down';\n})(WorkerStates || (exports.WorkerStates = WorkerStates = {}));\nlet WorkerEvents;\nexports.WorkerEvents = WorkerEvents;\n(function (WorkerEvents) {\n  WorkerEvents['STATE_CHANGE'] = 'state-change';\n})(WorkerEvents || (exports.WorkerEvents = WorkerEvents = {}));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }\nvar y = x => () => x\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"default\"]: () => __WEBPACK_EXTERNAL_MODULE_node_worker_threads_28ca7740__[\"default\"] });","var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }\nvar y = x => () => x\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"createRequire\"]: () => __WEBPACK_EXTERNAL_MODULE_node_module_9de3fa2f__.createRequire });","import worker_threads from 'node:worker_threads';\nimport { createRequire } from 'node:module';\n// @ts-expect-error\nimport * as types from '../../node_modules/jest-worker/build/types.js';\n\nlet file: any = null;\nlet setupArgs: any = [];\nlet initialized = false;\n\nconst require = createRequire(import.meta.url);\n\nconst messageListener = (request: any) => {\n  switch (request[0]) {\n    case types.CHILD_MESSAGE_INITIALIZE:\n      const init = request;\n      file = init[2];\n      setupArgs = init[3];\n      process.env.JEST_WORKER_ID = init[4];\n      break;\n    case types.CHILD_MESSAGE_CALL:\n      const call = request;\n      execMethod(call[2], call[3]);\n      break;\n    case types.CHILD_MESSAGE_END:\n      end();\n      break;\n    case types.CHILD_MESSAGE_MEM_USAGE:\n      reportMemoryUsage();\n      break;\n    default:\n      throw new TypeError(`Unexpected request from parent process: ${request[0]}`);\n  }\n};\nworker_threads.parentPort?.on('message', messageListener);\n\nfunction reportMemoryUsage() {\n  if (worker_threads.isMainThread) {\n    throw new Error('Child can only be used on a forked process');\n  }\n  const msg = [types.PARENT_MESSAGE_MEM_USAGE, process.memoryUsage().heapUsed];\n  worker_threads.parentPort?.postMessage(msg);\n}\n\nfunction reportSuccess(result: any) {\n  if (worker_threads.isMainThread) {\n    throw new Error('Child can only be used on a forked process');\n  }\n  worker_threads.parentPort?.postMessage([types.PARENT_MESSAGE_OK, result]);\n}\n\nfunction reportClientError(error: any) {\n  return reportError(error, types.PARENT_MESSAGE_CLIENT_ERROR);\n}\n\nfunction reportInitializeError(error: any) {\n  return reportError(error, types.PARENT_MESSAGE_SETUP_ERROR);\n}\n\nfunction reportError(error: any, type: any) {\n  if (worker_threads.isMainThread) {\n    throw new Error('Child can only be used on a forked process');\n  }\n  if (error == null) {\n    error = new Error('\"null\" or \"undefined\" thrown');\n  }\n  worker_threads.parentPort?.postMessage([\n    type,\n    error.constructor && error.constructor.name,\n    error.message,\n    error.stack,\n    typeof error === 'object'\n      ? {\n          ...error,\n        }\n      : error,\n  ]);\n}\n\nfunction end() {\n  const main = require(file);\n  if (!main.teardown) {\n    exitProcess();\n    return;\n  }\n  execFunction(main.teardown, main, [], exitProcess, exitProcess);\n}\n\nfunction exitProcess() {\n  // Clean up open handles so the worker ideally exits gracefully\n  worker_threads.parentPort?.removeListener('message', messageListener);\n}\n\nfunction execMethod(method: any, args: any) {\n  const main = require(file);\n  let fn: any;\n  if (method === 'default') {\n    fn = main.__esModule ? main.default : main;\n  } else {\n    fn = main[method];\n  }\n  function execHelper() {\n    execFunction(fn, main, args, reportSuccess, reportClientError);\n  }\n  if (initialized || !main.setup) {\n    execHelper();\n    return;\n  }\n  initialized = true;\n  execFunction(main.setup, main, setupArgs, execHelper, reportInitializeError);\n}\n\nfunction execFunction(fn: any, ctx: any, args: any, onResult: any, onError: any) {\n  let result;\n  try {\n    result = fn.apply(ctx, args);\n  } catch (err) {\n    onError(err);\n    return;\n  }\n  if (\n    (typeof result === 'object' || typeof result === 'function') &&\n    typeof (result as any)?.then === 'function'\n  ) {\n    result.then(onResult, onError);\n  } else {\n    onResult(result);\n  }\n}\n"],"names":["WorkerStates","WorkerEvents","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE_node_worker_threads_28ca7740__","x","__WEBPACK_EXTERNAL_MODULE_node_module_9de3fa2f__","createRequire","file","setupArgs","initialized","require","import","meta","url","messageListener","request","types","init","process","env","JEST_WORKER_ID","method","args","main","fn","execHelper","execFunction","reportSuccess","reportClientError","__esModule","default","setup","reportInitializeError","execMethod","teardown","exitProcess","end","worker_threads","Error","msg","memoryUsage","heapUsed","postMessage","reportMemoryUsage","TypeError","result","error","reportError","type","constructor","name","message","stack","removeListener","ctx","onResult","onError","apply","err","then","on"],"sourceRoot":""}